<template>
    <div class=" container mx-auto flex flex-col items-center gap-7" style="min-height: 93vh;">
        <template :key="item.id" v-for="item in serialized_post">
            <template v-if="item.type=='heading'">
                <h1 class="text-4xl font-bold font-dm-sans">{{project.title}}</h1>
            </template>
            <template v-else-if="item.type=='subheading'">
                <p class="indent text-center w-full">{{item.text}}</p>
            </template>
            <template v-else-if="item.type=='images'">
                <template v-if="item.srcs.length==1">
                    <img class="object-cover object-center" :src="item.srcs[0]"/>
                </template>
                <template v-else-if="item.srcs.length==2">
                    <div class="flex gap-3 flex-col md:flex-row">
                        <img class="object-cover object-center w-full md:w-1/2" :src="item.srcs[0]" alt="">
                        <img class="object-cover object-center w-full md:w-1/2" :src="item.srcs[1]" alt="">
                    </div>
                </template>
            </template>
            <template v-else-if="item.type=='action'">
                <div class="indent w-full">
                    <a :href="item.link" class=" bg-gray-900 text-white px-6 py-3 flex w-max items-center gap-4">
                        <!-- GITHUB -->
                        <template v-if="item.platform=='github'">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M10.0217 1.66669C5.9441 1.66616 2.46817 4.62334 1.81533 8.6483C1.16248 12.6733 3.52549 16.5775 7.39416 17.8659C7.81083 17.9409 7.95999 17.685 7.95999 17.465C7.95999 17.2675 7.95333 16.7442 7.95083 16.0484C5.63833 16.5484 5.14999 14.9334 5.14999 14.9334C4.99776 14.4308 4.67047 13.9995 4.22749 13.7175C3.47749 13.2017 4.28499 13.2134 4.28499 13.2134C4.81889 13.2866 5.28879 13.6029 5.55749 14.07C5.78494 14.4836 6.16813 14.7891 6.62191 14.9189C7.0757 15.0486 7.56251 14.9917 7.97416 14.7609C8.01284 14.3392 8.20044 13.9451 8.50333 13.6492C6.65833 13.44 4.71833 12.7267 4.71833 9.54085C4.70809 8.71685 5.01408 7.92027 5.57333 7.31502C5.32028 6.59778 5.35008 5.81106 5.65666 5.11502C5.65666 5.11502 6.35416 4.89085 7.94166 5.96585C9.3032 5.59253 10.7401 5.59253 12.1017 5.96585C13.69 4.89002 14.3867 5.11502 14.3867 5.11502C14.6947 5.81074 14.7245 6.598 14.47 7.31502C15.0313 7.92021 15.337 8.71889 15.3233 9.54419C15.3233 12.7384 13.3817 13.44 11.53 13.6459C11.9294 14.0542 12.1343 14.6145 12.0925 15.1842C12.0925 16.2959 12.0825 17.1925 12.0825 17.465C12.0825 17.6875 12.2308 17.9459 12.655 17.8642C16.522 16.5736 18.8825 12.6692 18.2283 8.64528C17.5741 4.6214 14.0984 1.66575 10.0217 1.66669Z" fill="currentColor"/>
                            </svg>
                        </template>
                        <!-- INSTA -->
                        <template v-if="item.platform=='instagram'">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M10.0016 17.5342C7.95165 17.5342 7.70998 17.5234 6.90998 17.4884C6.28612 17.4679 5.67034 17.341 5.08915 17.1134C4.08357 16.722 3.28843 15.9266 2.89748 14.9209C2.67857 14.3376 2.5605 13.7213 2.54831 13.0984C2.50165 12.3 2.50165 12.0384 2.50165 10.0042C2.50165 7.94838 2.51248 7.70838 2.54831 6.91254C2.56076 6.29048 2.67883 5.67505 2.89748 5.09254C3.28801 4.08549 4.08444 3.28936 5.09165 2.89921C5.67385 2.67938 6.28944 2.561 6.91165 2.54921C7.70748 2.50421 7.96915 2.50421 10.0016 2.50421C12.0683 2.50421 12.3058 2.51504 13.0933 2.54921C13.7171 2.5611 14.3344 2.67947 14.9183 2.89921C15.9252 3.2898 16.7215 4.08577 17.1125 5.09254C17.3351 5.68354 17.4538 6.30859 17.4633 6.94004C17.51 7.73838 17.51 7.99921 17.51 10.0325C17.51 12.0659 17.4983 12.3325 17.4633 13.1217C17.4509 13.7452 17.3326 14.3621 17.1133 14.9459C16.7214 15.9523 15.925 16.748 14.9183 17.1392C14.3352 17.3577 13.7192 17.4758 13.0966 17.4884C12.3008 17.5342 12.04 17.5342 10.0016 17.5342ZM9.97331 3.82338C7.93498 3.82338 7.72331 3.83338 6.92748 3.86921C6.45247 3.8755 5.98205 3.96316 5.53665 4.12838C4.87894 4.38005 4.3585 4.89837 4.10415 5.55504C3.93766 6.00529 3.84999 6.48086 3.84498 6.96088C3.80081 7.76838 3.80081 7.98005 3.80081 10.0042C3.80081 12.0042 3.80831 12.2467 3.84498 13.0492C3.85244 13.5244 3.94006 13.9949 4.10415 14.4409C4.35888 15.0971 4.87923 15.615 5.53665 15.8667C5.98174 16.033 6.45236 16.1207 6.92748 16.1259C7.73415 16.1725 7.94665 16.1725 9.97331 16.1725C12.0175 16.1725 12.2291 16.1625 13.0183 16.1259C13.4936 16.1201 13.9644 16.0324 14.41 15.8667C15.0637 15.6129 15.5808 15.0961 15.835 14.4425C16.0011 13.9919 16.0888 13.5161 16.0941 13.0359H16.1033C16.1391 12.2392 16.1391 12.0267 16.1391 9.99088C16.1391 7.95505 16.13 7.74088 16.0941 6.94504C16.0867 6.47042 15.9991 6.00047 15.835 5.55504C15.5813 4.90052 15.0642 4.38279 14.41 4.12838C13.9645 3.96233 13.4937 3.87465 13.0183 3.86921C12.2125 3.82338 12.0016 3.82338 9.97331 3.82338ZM10.0016 13.8534C8.44331 13.8544 7.03783 12.9165 6.4407 11.4771C5.84357 10.0377 6.1724 8.38032 7.27384 7.27793C8.37528 6.17554 10.0324 5.84527 11.4723 6.44115C12.9122 7.03704 13.8513 8.4417 13.8516 10C13.8494 12.1259 12.1275 13.8492 10.0016 13.8534ZM10.0016 7.49838C8.62094 7.49838 7.50165 8.61767 7.50165 9.99838C7.50165 11.3791 8.62094 12.4984 10.0016 12.4984C11.3824 12.4984 12.5016 11.3791 12.5016 9.99838C12.4984 8.619 11.381 7.50159 10.0016 7.49838ZM14.0016 6.90421C13.5062 6.90237 13.1057 6.4997 13.1066 6.00422C13.1076 5.50874 13.5095 5.10755 14.005 5.10755C14.5005 5.10755 14.9024 5.50873 14.9033 6.00421C14.9035 6.24326 14.8086 6.47256 14.6394 6.64144C14.4702 6.81032 14.2407 6.90488 14.0016 6.90421Z" fill="currentColor"/>
                            </svg>
                        </template>
                        <!-- FIGMA -->
                        <template v-if="item.platform=='figma'">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8.94504 22.0001C7.28013 22.013 5.78874 20.9726 5.22604 19.4056C4.66335 17.8386 5.15219 16.0871 6.44504 15.038C5.52804 14.2958 4.99527 13.1792 4.99527 11.9995C4.99527 10.8198 5.52804 9.7032 6.44504 8.96102C5.15177 7.91226 4.66264 6.16065 5.22544 4.59358C5.78825 3.02651 7.28003 1.98634 8.94504 1.99989H15.055C16.72 1.98634 18.2118 3.02651 18.7746 4.59358C19.3374 6.16065 18.8483 7.91226 17.555 8.96102C18.8479 10.0101 19.3367 11.7616 18.774 13.3286C18.2113 14.8956 16.72 15.936 15.055 15.923C14.286 15.924 13.5335 15.7001 12.89 15.279V18.079C12.8807 20.25 11.116 22.0039 8.94504 22.0001ZM8.92304 15.924C7.73858 15.9427 6.79173 16.9148 6.80416 18.0993C6.81658 19.2839 7.7836 20.2359 8.96819 20.2298C10.1528 20.2236 11.1099 19.2616 11.11 18.077V15.924H8.92204H8.92304ZM15.056 9.84702C13.8684 9.85309 12.91 10.8197 12.914 12.0073C12.9181 13.1949 13.8831 14.155 15.0707 14.153C16.2583 14.151 17.22 13.1877 17.22 12C17.2156 10.8081 16.247 9.84481 15.055 9.84702H15.056ZM8.94604 9.84699C8.17685 9.84291 7.46389 10.2495 7.07574 10.9136C6.68758 11.5776 6.6832 12.3984 7.06424 13.0666C7.44527 13.7348 8.15385 14.1489 8.92304 14.153H11.11V9.84699H8.94604ZM12.89 3.77002V8.07704H15.054C16.2115 8.08242 17.1666 7.17244 17.217 6.01602V6.45102V5.92302C17.2121 4.7325 16.2456 3.77002 15.055 3.77002H12.89ZM8.94404 3.77002C8.17485 3.77002 7.46408 4.18038 7.07949 4.84652C6.69489 5.51266 6.69489 6.33338 7.07949 6.99952C7.46408 7.66566 8.17485 8.07602 8.94404 8.07602H11.11V3.77002H8.94404Z" fill="#2E3A59"/>
                            </svg>
                        </template>
                        <!-- APPSTORE -->
                        <template v-if="item.platform=='appstore'">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C21.9939 17.5203 17.5203 21.9939 12 22ZM7.727 14.787C7.598 14.7878 7.46951 14.8032 7.344 14.833L7.194 14.874L6.6 15.891C6.37467 16.2669 6.48338 16.7534 6.84727 16.9976C7.21116 17.2418 7.70258 17.158 7.965 16.807L8.027 16.714L8.817 15.343C8.55744 14.9959 8.15043 14.7901 7.717 14.787H7.727ZM13.211 8.66C12.8999 8.95227 12.6936 9.33883 12.624 9.76C12.5125 10.3407 12.6193 10.9422 12.924 11.449L15.964 16.715C16.1125 16.9661 16.3823 17.1204 16.674 17.121C16.7991 17.1206 16.9225 17.0919 17.035 17.037C17.4205 16.8469 17.5948 16.3921 17.435 15.993L17.386 15.893L16.586 14.502H17.776C18.2084 14.4984 18.5642 14.1608 18.5906 13.7291C18.6169 13.2975 18.3047 12.9192 17.876 12.863L17.776 12.857H15.636L13.442 9.057L13.213 8.657L13.211 8.66ZM6.26 12.85C6.15402 12.8501 6.04908 12.8708 5.951 12.911C5.85161 12.9525 5.76126 13.013 5.685 13.089C5.53094 13.2435 5.4446 13.4528 5.445 13.671C5.44514 14.0854 5.753 14.4352 6.164 14.488L6.264 14.493H13.744C13.9118 14.1556 13.9055 13.7578 13.727 13.426C13.575 13.1149 13.2773 12.9005 12.934 12.855L12.813 12.849H10.262L13.79 6.74C13.8987 6.55063 13.9281 6.326 13.872 6.115C13.8162 5.90362 13.6778 5.72349 13.488 5.615C13.131 5.40943 12.677 5.49912 12.425 5.825L12.363 5.917L12 6.551L11.641 5.917C11.4925 5.66592 11.2227 5.51164 10.931 5.511C10.8056 5.51145 10.6818 5.54016 10.569 5.595C10.1837 5.78588 10.0097 6.24065 10.169 6.64L10.218 6.74L11.048 8.2L8.363 12.85H6.26Z" fill="#2E3A59"/>
                            </svg>
                        </template>
                        <!-- PLAYSTORE -->
                        <template v-if="item.platform=='playstore'">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M5.39997 21C5.2294 21.0028 5.05982 20.9736 4.89997 20.914L12.954 12.857L15.62 15.526L6.36497 20.726C6.0718 20.8979 5.73969 20.9922 5.39997 21ZM4.23597 20.335C4.07225 20.0385 3.99077 19.7036 3.99997 19.365V4.66004C3.99862 4.43682 4.03236 4.21478 4.09997 4.00204L12.333 12.237L4.23297 20.337L4.23597 20.335ZM16.415 15.077L13.574 12.238L16.707 9.10604L19.49 10.669C20.0242 10.9081 20.3816 11.4239 20.418 12.008C20.3818 12.5928 20.0239 13.1091 19.489 13.348L16.415 15.077ZM12.954 11.614L4.61397 3.27504C4.84295 3.10572 5.12018 3.01424 5.40497 3.01404C5.74131 3.02598 6.06944 3.12116 6.35997 3.29104L15.911 8.65904L12.955 11.614H12.954Z" fill="#2E3A59"/>
                            </svg>
                        </template>
                        <!-- DRIBBBLE -->
                        <template v-if="item.platform=='dribbble'">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C21.9939 17.5203 17.5203 21.9939 12 22ZM7.12 18.545L7.115 18.555C9.39805 20.2653 12.4093 20.6571 15.054 19.588C14.6749 17.5493 14.113 15.5489 13.375 13.611C11.6799 14.202 10.1302 15.1473 8.829 16.384C8.18773 16.9912 7.63257 17.6833 7.179 18.441L7.172 18.452V18.442L7.154 18.477L7.142 18.497L7.135 18.51L7.118 18.546L7.12 18.545ZM16.779 13.045C16.2867 13.0457 15.7949 13.0791 15.307 13.145C15.9442 14.9255 16.4456 16.7517 16.807 18.608C18.5064 17.383 19.6615 15.5438 20.027 13.481C18.969 13.1891 17.8765 13.0414 16.779 13.042V13.045ZM3.817 11.955V12.011C3.81882 13.9376 4.50052 15.8017 5.742 17.275C7.35028 14.7905 9.72927 12.9023 12.514 11.9L12.633 11.866C12.456 11.475 12.29 11.126 12.124 10.8C9.45593 11.5481 6.6999 11.9365 3.929 11.955H3.817ZM16.466 11.349C17.7068 11.3536 18.9449 11.4667 20.166 11.687C20.1024 9.99541 19.5107 8.3662 18.474 7.028C17.2642 8.38093 15.7585 9.43634 14.074 10.112L14.103 10.1L14.072 10.113C14.251 10.486 14.408 10.835 14.539 11.146C14.57 11.22 14.596 11.284 14.62 11.346L14.661 11.446C15.2603 11.3795 15.863 11.3471 16.466 11.349ZM8.377 4.677C6.20231 5.75037 4.61618 7.73358 4.047 10.091C6.37738 10.055 8.69657 9.76053 10.962 9.213H10.975H10.99L11 9.2L11.054 9.187H11.06L11.1 9.179H11.109H11.116L11.137 9.173L11.177 9.163L11.2 9.153L11.222 9.147H11.232H11.242C9.909 6.8 8.529 4.887 8.376 4.677H8.377ZM12 3.83897C11.4526 3.83762 10.9063 3.88953 10.369 3.994C11.4166 5.44558 12.3779 6.95753 13.248 8.522C14.8061 7.96705 16.1958 7.02157 17.284 5.776C15.8067 4.5266 13.9348 3.84041 12 3.83897Z" fill="#2E3A59"/>
                            </svg>
                        </template>
                        <!-- DRIVE -->
                        <template v-if="item.platform=='drive' || item.platform=='googledrive'">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M7.94 4.33901L11.422 10.369L5.482 20.662L2 14.633L7.94 4.33901ZM10.116 14.633H22L18.518 20.662H6.635L10.116 14.633ZM14.459 13.633L8.518 3.33801H15.482L21.422 13.633H14.46H14.459Z" fill="#2E3A59"/>
                            </svg>
                        </template>
                        <span>
                            See on {{item.platform}}
                        </span>
                        </a>
                </div>
            </template>
            <template v-else-if="item.type=='list'">
                <div class="pl-4 md:pl-7 w-full indent">
                    <p class="" :key="text" v-for="text in item.items">- {{text}}</p>
                </div>
            </template>
            <template v-else-if="item.type=='title'">
                <h2 class="indent font-dm-sans text-xl font-semibold text-left w-full">{{item.text}}</h2>
            </template>
            <template v-else-if="item.type=='paragraph'">
                <p class="indent text-left w-full">{{item.text}}</p>
            </template>
            <template v-else-if="item.type=='viewcount'">
                <p class="w-full text-left indent">{{project.read_count}} {{(project.read_count==1) ? 'view':'views'}}</p>
            </template>
            <template v-else-if="item.type=='serialization-error'">
                <div class="pt-56 flex flex-col gap-2 items-center">
                    <h1 class="font-dm-sans font-medium text-2xl">Serializations error</h1>
                    <p class=" text-gray-700">Could not serialize this blog post</p>
                    <router-link to="/" class="bg-gray-900 w-max px-6 py-3 text-white border border-gray-900 hover:bg-white hover:text-gray-900 transition-all delay-75">Go Home.</router-link>
                </div>
            </template>
        </template>

        <!-- ... -->
        <div class=" h-16"/>
    </div>
</template>

<style scoped>
.indent{
    max-width: 800px;
}
</style>


<script>
import { analytic_ping } from '../api';
export default {
    data: function (){
        return {
            serialized_post: []
        }
    },
    props: {
        project: {type: Object, required: true}
    },
    created: function(){
        try{
            this.serialized_post = JSON.parse(this.project.article);
            for (let i=0; i<this.serialized_post.length; i++) {
                const item = this.serialized_post[i];
                item["id"] = i;
                item.type = item.type.toLowerCase()
                if (item.platform){
                    item.platform = item.platform.toLowerCase()
                }
            }
            
            // analytics
            analytic_ping(this.project.id)
        }catch (e){
            this.serialized_post = [
                {"type": "serialization-error"}
            ];
        }
    }
}
</script>